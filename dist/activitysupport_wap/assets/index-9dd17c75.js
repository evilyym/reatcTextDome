import{a as _,F as Te,t as ee,J as Ct,w as oe,x as Ke,y as Ge,v as $e,z as r,f as ne,h as Q,H as Je,K as V,D as se,m as J,B as D,A as j,aI as St,ab as te,aJ as ie,ad as Ve,U as Qe,k as H,G as ye,aK as pe,aL as Bt,O as It,aM as et,aN as De,aO as xt,T as Pe,j as Se,L as we,X as Pt,aP as kt,p as tt,C as de,M as le,aQ as ke,aR as Tt,a0 as re,as as Rt,aS as Et,a3 as Ot,i as _e,d as nt,Y as ze,aT as zt,aU as Lt,aV as At,aW as $t,a1 as be,aa as at,aX as Ue,aY as Vt,aZ as Dt,Q as Me,a_ as ot,a$ as lt,b0 as _t,E as Ce,b1 as ue,r as Mt,b2 as Ft,a8 as it,a6 as Ut,a4 as rt,b3 as Nt,a2 as Ne}from"./index-6ea632fd.js";import{a as st,c as ct,d as Yt,u as Ht,C as jt,b as Wt,S as Xt}from"./_plugin-vue_export-helper-a6759dd1.js";const Zt=(e,a)=>{const o=_(),t=()=>{o.value=$e(e).height};return Te(()=>{if(ee(t),a)for(let l=1;l<=3;l++)setTimeout(t,100*l)}),Ct(()=>ee(t)),oe([Ke,Ge],t),o};function qt(e,a){const o=Zt(e,!0);return t=>r("div",{class:a("placeholder"),style:{height:o.value?`${o.value}px`:void 0}},[t()])}const[ut,Ye]=ne("action-bar"),dt=Symbol(ut),Kt={placeholder:Boolean,safeAreaInsetBottom:V};var Gt=Q({name:ut,props:Kt,setup(e,{slots:a}){const o=_(),t=qt(o,Ye),{linkChildren:l}=Je(dt);l();const s=()=>{var S;return r("div",{ref:o,class:[Ye(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[(S=a.default)==null?void 0:S.call(a)])};return()=>e.placeholder?t(s):s()}});const Jt=se(Gt),[Qt,me]=ne("button"),pt=J({},st,{tag:D("button"),text:String,icon:String,type:D("default"),size:D("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:D("button"),loadingSize:j,loadingText:String,loadingType:String,iconPosition:D("left")});var en=Q({name:Qt,props:pt,emits:["click"],setup(e,{emit:a,slots:o}){const t=ct(),l=()=>o.loading?o.loading():r(Ve,{size:e.loadingSize,type:e.loadingType,class:me("loading")},null),s=()=>{if(e.loading)return l();if(o.icon)return r("div",{class:me("icon")},[o.icon()]);if(e.icon)return r(te,{name:e.icon,class:me("icon"),classPrefix:e.iconPrefix},null)},S=()=>{let m;if(e.loading?m=e.loadingText:m=o.default?o.default():e.text,m)return r("span",{class:me("text")},[m])},y=()=>{const{color:m,plain:u}=e;if(m){const b={color:u?m:"white"};return u||(b.background=m),m.includes("gradient")?b.border=0:b.borderColor=m,b}},h=m=>{e.loading?ie(m):e.disabled||(a("click",m),t())};return()=>{const{tag:m,type:u,size:b,block:x,round:T,plain:R,square:L,loading:i,disabled:c,hairline:v,nativeType:g,iconPosition:w}=e,E=[me([u,b,{plain:R,block:x,round:T,square:L,loading:i,disabled:c,hairline:v}]),{[St]:v}];return r(m,{type:g,class:E,style:y(),disabled:c,onClick:h},{default:()=>[r("div",{class:me("content")},[w==="left"&&s(),S(),w==="right"&&s()])]})}}});const Le=se(en),[tn,nn]=ne("action-bar-button"),an=J({},st,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var on=Q({name:tn,props:an,setup(e,{slots:a}){const o=ct(),{parent:t,index:l}=Qe(dt),s=H(()=>{if(t){const y=t.children[l.value-1];return!(y&&"isButton"in y)}}),S=H(()=>{if(t){const y=t.children[l.value+1];return!(y&&"isButton"in y)}});return ye({isButton:!0}),()=>{const{type:y,icon:h,text:m,color:u,loading:b,disabled:x}=e;return r(Le,{class:nn([y,{last:S.value,first:s.value}]),size:"large",type:y,icon:h,color:u,loading:b,disabled:x,onClick:o},{default:()=>[a.default?a.default():m]})}}});const He=se(on),[ln,rn]=ne("form"),sn={colon:Boolean,disabled:Boolean,readonly:Boolean,required:[Boolean,String],showError:Boolean,labelWidth:j,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:V,showErrorMessage:V,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var cn=Q({name:ln,props:sn,emits:["submit","failed"],setup(e,{emit:a,slots:o}){const{children:t,linkChildren:l}=Je(pe),s=i=>i?t.filter(c=>i.includes(c.name)):t,S=i=>new Promise((c,v)=>{const g=[];s(i).reduce((E,M)=>E.then(()=>{if(!g.length)return M.validate().then(q=>{q&&g.push(q)})}),Promise.resolve()).then(()=>{g.length?v(g):c()})}),y=i=>new Promise((c,v)=>{const g=s(i);Promise.all(g.map(w=>w.validate())).then(w=>{w=w.filter(Boolean),w.length?v(w):c()})}),h=i=>{const c=t.find(v=>v.name===i);return c?new Promise((v,g)=>{c.validate().then(w=>{w?g(w):v()})}):Promise.reject()},m=i=>typeof i=="string"?h(i):e.validateFirst?S(i):y(i),u=i=>{typeof i=="string"&&(i=[i]),s(i).forEach(v=>{v.resetValidation()})},b=()=>t.reduce((i,c)=>(i[c.name]=c.getValidationStatus(),i),{}),x=(i,c)=>{t.some(v=>v.name===i?(v.$el.scrollIntoView(c),!0):!1)},T=()=>t.reduce((i,c)=>(c.name!==void 0&&(i[c.name]=c.formValue.value),i),{}),R=()=>{const i=T();m().then(()=>a("submit",i)).catch(c=>{a("failed",{values:i,errors:c}),e.scrollToError&&c[0].name&&x(c[0].name)})},L=i=>{ie(i),R()};return l({props:e}),ye({submit:R,validate:m,getValues:T,scrollToField:x,resetValidation:u,getValidationStatus:b}),()=>{var i;return r("form",{class:rn(),onSubmit:L},[(i=o.default)==null?void 0:i.call(o)])}}});const Kn=se(cn);function ft(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function un(e,a){if(ft(e)){if(a.required)return!1;if(a.validateEmpty===!1)return!0}return!(a.pattern&&!a.pattern.test(String(e)))}function dn(e,a){return new Promise(o=>{const t=a.validator(e,a);if(et(t)){t.then(o);return}o(t)})}function je(e,a){const{message:o}=a;return De(o)?o(e,a):o||""}function fn({target:e}){e.composing=!0}function We({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function gn(e,a){const o=Bt();e.style.height="auto";let t=e.scrollHeight;if(xt(a)){const{maxHeight:l,minHeight:s}=a;l!==void 0&&(t=Math.min(t,l)),s!==void 0&&(t=Math.max(t,s))}t&&(e.style.height=`${t}px`,It(o))}function mn(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function ae(e){return[...e].length}function Ee(e,a){return[...e].slice(0,a).join("")}const[vn,Z]=ne("field"),hn={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:j,formatter:Function,clearIcon:D("clear"),modelValue:de(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:D("focus"),formatTrigger:D("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},bn=J({},Yt,hn,{rows:j,type:D("text"),rules:Array,autosize:[Boolean,Object],labelWidth:j,labelClass:Pe,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var wn=Q({name:vn,props:bn,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:a,slots:o}){const t=Ht(),l=Se({status:"unvalidated",focused:!1,validateMessage:""}),s=_(),S=_(),y=_(),{parent:h}=Qe(pe),m=()=>{var n;return String((n=e.modelValue)!=null?n:"")},u=n=>{if(le(e[n]))return e[n];if(h&&le(h.props[n]))return h.props[n]},b=H(()=>{const n=u("readonly");if(e.clearable&&!n){const B=m()!=="",I=e.clearTrigger==="always"||e.clearTrigger==="focus"&&l.focused;return B&&I}return!1}),x=H(()=>y.value&&o.input?y.value():e.modelValue),T=H(()=>{var n;const B=u("required");return B==="auto"?(n=e.rules)==null?void 0:n.some(I=>I.required):B}),R=n=>n.reduce((B,I)=>B.then(()=>{if(l.status==="failed")return;let{value:z}=x;if(I.formatter&&(z=I.formatter(z,I)),!un(z,I)){l.status="failed",l.validateMessage=je(z,I);return}if(I.validator)return ft(z)&&I.validateEmpty===!1?void 0:dn(z,I).then($=>{$&&typeof $=="string"?(l.status="failed",l.validateMessage=$):$===!1&&(l.status="failed",l.validateMessage=je(z,I))})}),Promise.resolve()),L=()=>{l.status="unvalidated",l.validateMessage=""},i=()=>a("endValidate",{status:l.status,message:l.validateMessage}),c=(n=e.rules)=>new Promise(B=>{L(),n?(a("startValidate"),R(n).then(()=>{l.status==="failed"?(B({name:e.name,message:l.validateMessage}),i()):(l.status="passed",B(),i())})):B()}),v=n=>{if(h&&e.rules){const{validateTrigger:B}=h.props,I=ke(B).includes(n),z=e.rules.filter($=>$.trigger?ke($.trigger).includes(n):I);z.length&&c(z)}},g=n=>{var B;const{maxlength:I}=e;if(le(I)&&ae(n)>+I){const z=m();if(z&&ae(z)===+I)return z;const $=(B=s.value)==null?void 0:B.selectionEnd;if(l.focused&&$){const Y=[...n],K=Y.length-+I;return Y.splice($-K,K),Y.join("")}return Ee(n,+I)}return n},w=(n,B="onChange")=>{const I=n;n=g(n);const z=ae(I)-ae(n);if(e.type==="number"||e.type==="digit"){const Y=e.type==="number";n=Tt(n,Y,Y)}let $=0;if(e.formatter&&B===e.formatTrigger){const{formatter:Y,maxlength:K}=e;if(n=Y(n),le(K)&&ae(n)>+K&&(n=Ee(n,+K)),s.value&&l.focused){const{selectionEnd:Be}=s.value,Fe=Ee(I,Be);$=ae(Y(Fe))-ae(Fe)}}if(s.value&&s.value.value!==n)if(l.focused){let{selectionStart:Y,selectionEnd:K}=s.value;if(s.value.value=n,le(Y)&&le(K)){const Be=ae(n);z?(Y-=z,K-=z):$&&(Y+=$,K+=$),s.value.setSelectionRange(Math.min(Y,Be),Math.min(K,Be))}}else s.value.value=n;n!==e.modelValue&&a("update:modelValue",n)},E=n=>{n.target.composing||w(n.target.value)},M=()=>{var n;return(n=s.value)==null?void 0:n.blur()},q=()=>{var n;return(n=s.value)==null?void 0:n.focus()},d=()=>{const n=s.value;e.type==="textarea"&&e.autosize&&n&&gn(n,e.autosize)},P=n=>{l.focused=!0,a("focus",n),ee(d),u("readonly")&&M()},F=n=>{l.focused=!1,w(m(),"onBlur"),a("blur",n),!u("readonly")&&(v("onBlur"),ee(d),Et())},O=n=>a("clickInput",n),W=n=>a("clickLeftIcon",n),X=n=>a("clickRightIcon",n),fe=n=>{ie(n),a("update:modelValue",""),a("clear",n)},ce=H(()=>{if(typeof e.error=="boolean")return e.error;if(h&&h.props.showError&&l.status==="failed")return!0}),f=H(()=>{const n=u("labelWidth"),B=u("labelAlign");if(n&&B!=="top")return{width:we(n)}}),C=n=>{n.keyCode===13&&(!(h&&h.props.submitOnEnter)&&e.type!=="textarea"&&ie(n),e.type==="search"&&M()),a("keypress",n)},k=()=>e.id||`${t}-input`,U=()=>l.status,N=()=>{const n=Z("control",[u("inputAlign"),{error:ce.value,custom:!!o.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(o.input)return r("div",{class:n,onClick:O},[o.input()]);const B={id:k(),ref:s,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:n,disabled:u("disabled"),readonly:u("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${t}-label`:void 0,onBlur:F,onFocus:P,onInput:E,onClick:O,onChange:We,onKeypress:C,onCompositionend:We,onCompositionstart:fn};return e.type==="textarea"?r("textarea",B,null):r("input",re(mn(e.type),B),null)},p=()=>{const n=o["left-icon"];if(e.leftIcon||n)return r("div",{class:Z("left-icon"),onClick:W},[n?n():r(te,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},ge=()=>{const n=o["right-icon"];if(e.rightIcon||n)return r("div",{class:Z("right-icon"),onClick:X},[n?n():r(te,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Re=()=>{if(e.showWordLimit&&e.maxlength){const n=ae(m());return r("div",{class:Z("word-limit")},[r("span",{class:Z("word-num")},[n]),Rt("/"),e.maxlength])}},bt=()=>{if(h&&h.props.showErrorMessage===!1)return;const n=e.errorMessage||l.validateMessage;if(n){const B=o["error-message"],I=u("errorMessageAlign");return r("div",{class:Z("error-message",I)},[B?B({message:n}):n])}},wt=()=>{const n=u("labelWidth"),B=u("labelAlign"),I=u("colon")?":":"";if(o.label)return[o.label(),I];if(e.label)return r("label",{id:`${t}-label`,for:o.input?void 0:k(),onClick:z=>{ie(z),q()},style:B==="top"&&n?{width:we(n)}:void 0},[e.label+I])},yt=()=>[r("div",{class:Z("body")},[N(),b.value&&r(te,{ref:S,name:e.clearIcon,class:Z("clear")},null),ge(),o.button&&r("div",{class:Z("button")},[o.button()])]),Re(),bt()];return ye({blur:M,focus:q,validate:c,formValue:x,resetValidation:L,getValidationStatus:U}),Pt(kt,{customValue:y,resetValidation:L,validateWithTrigger:v}),oe(()=>e.modelValue,()=>{w(m()),L(),v("onChange"),ee(d)}),Te(()=>{w(m(),e.formatTrigger),ee(d)}),tt("touchstart",fe,{target:H(()=>{var n;return(n=S.value)==null?void 0:n.$el})}),()=>{const n=u("disabled"),B=u("labelAlign"),I=p(),z=()=>{const $=wt();return B==="top"?[I,$].filter(Boolean):$||[]};return r(jt,{size:e.size,class:Z({error:ce.value,disabled:n,[`label-${B}`]:B}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:f.value,valueClass:Z("value"),titleClass:[Z("label",[B,{required:T.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:I&&B!=="top"?()=>I:null,title:z,value:yt,extra:o.extra})}}});const Gn=se(wn),[yn,ve]=ne("image"),Cn={src:String,alt:String,fit:String,position:String,round:Boolean,block:Boolean,width:j,height:j,radius:j,lazyLoad:Boolean,iconSize:j,showError:V,errorIcon:D("photo-fail"),iconPrefix:String,showLoading:V,loadingIcon:D("photo"),crossorigin:String,referrerpolicy:String};var Sn=Q({name:yn,props:Cn,emits:["load","error"],setup(e,{emit:a,slots:o}){const t=_(!1),l=_(!0),s=_(),{$Lazyload:S}=Ot().proxy,y=H(()=>{const i={width:we(e.width),height:we(e.height)};return le(e.radius)&&(i.overflow="hidden",i.borderRadius=we(e.radius)),i});oe(()=>e.src,()=>{t.value=!1,l.value=!0});const h=i=>{l.value&&(l.value=!1,a("load",i))},m=()=>{const i=new Event("load");Object.defineProperty(i,"target",{value:s.value,enumerable:!0}),h(i)},u=i=>{t.value=!0,l.value=!1,a("error",i)},b=(i,c,v)=>v?v():r(te,{name:i,size:e.iconSize,class:c,classPrefix:e.iconPrefix},null),x=()=>{if(l.value&&e.showLoading)return r("div",{class:ve("loading")},[b(e.loadingIcon,ve("loading-icon"),o.loading)]);if(t.value&&e.showError)return r("div",{class:ve("error")},[b(e.errorIcon,ve("error-icon"),o.error)])},T=()=>{if(t.value||!e.src)return;const i={alt:e.alt,class:ve("img"),style:{objectFit:e.fit,objectPosition:e.position},crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy};return e.lazyLoad?ze(r("img",re({ref:s},i),null),[[zt("lazy"),e.src]]):r("img",re({ref:s,src:e.src,onLoad:h,onError:u},i),null)},R=({el:i})=>{const c=()=>{i===s.value&&l.value&&m()};s.value?c():ee(c)},L=({el:i})=>{i===s.value&&!t.value&&u()};return S&&_e&&(S.$on("loaded",R),S.$on("error",L),nt(()=>{S.$off("loaded",R),S.$off("error",L)})),Te(()=>{ee(()=>{var i;(i=s.value)!=null&&i.complete&&!e.lazyLoad&&m()})}),()=>{var i;return r("div",{class:ve({round:e.round,block:e.block}),style:y.value},[T(),x(),(i=o.default)==null?void 0:i.call(o)])}}});const gt=se(Sn),[Bn,G,Ie]=ne("dialog"),In=J({},Lt,{title:String,theme:String,width:j,message:[String,Function],callback:Function,allowHtml:Boolean,className:Pe,transition:D("van-dialog-bounce"),messageAlign:String,closeOnPopstate:V,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:V,closeOnClickOverlay:Boolean}),xn=[...At,"transition","closeOnPopstate"];var Pn=Q({name:Bn,props:In,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:a,slots:o}){const t=_(),l=Se({confirm:!1,cancel:!1}),s=c=>a("update:show",c),S=c=>{var v;s(!1),(v=e.callback)==null||v.call(e,c)},y=c=>()=>{e.show&&(a(c),e.beforeClose?(l[c]=!0,Me(e.beforeClose,{args:[c],done(){S(c),l[c]=!1},canceled(){l[c]=!1}})):S(c))},h=y("cancel"),m=y("confirm"),u=$t(c=>{var v,g;if(c.target!==((g=(v=t.value)==null?void 0:v.popupRef)==null?void 0:g.value))return;({Enter:e.showConfirmButton?m:Ue,Escape:e.showCancelButton?h:Ue})[c.key](),a("keydown",c)},["enter","esc"]),b=()=>{const c=o.title?o.title():e.title;if(c)return r("div",{class:G("header",{isolated:!e.message&&!o.default})},[c])},x=c=>{const{message:v,allowHtml:g,messageAlign:w}=e,E=G("message",{"has-title":c,[w]:w}),M=De(v)?v():v;return g&&typeof M=="string"?r("div",{class:E,innerHTML:M},null):r("div",{class:E},[M])},T=()=>{if(o.default)return r("div",{class:G("content")},[o.default()]);const{title:c,message:v,allowHtml:g}=e;if(v){const w=!!(c||o.title);return r("div",{key:g?1:0,class:G("content",{isolated:!w})},[x(w)])}},R=()=>r("div",{class:[Dt,G("footer")]},[e.showCancelButton&&r(Le,{size:"large",text:e.cancelButtonText||Ie("cancel"),class:G("cancel"),style:{color:e.cancelButtonColor},loading:l.cancel,disabled:e.cancelButtonDisabled,onClick:h},null),e.showConfirmButton&&r(Le,{size:"large",text:e.confirmButtonText||Ie("confirm"),class:[G("confirm"),{[Vt]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:l.confirm,disabled:e.confirmButtonDisabled,onClick:m},null)]),L=()=>r(Jt,{class:G("footer")},{default:()=>[e.showCancelButton&&r(He,{type:"warning",text:e.cancelButtonText||Ie("cancel"),class:G("cancel"),color:e.cancelButtonColor,loading:l.cancel,disabled:e.cancelButtonDisabled,onClick:h},null),e.showConfirmButton&&r(He,{type:"danger",text:e.confirmButtonText||Ie("confirm"),class:G("confirm"),color:e.confirmButtonColor,loading:l.confirm,disabled:e.confirmButtonDisabled,onClick:m},null)]}),i=()=>o.footer?o.footer():e.theme==="round-button"?L():R();return()=>{const{width:c,title:v,theme:g,message:w,className:E}=e;return r(at,re({ref:t,role:"dialog",class:[G([g]),E],style:{width:we(c)},tabindex:0,"aria-labelledby":v||w,onKeydown:u,"onUpdate:show":s},be(e,xn)),{default:()=>[b(),T(),i()]})}}});let Ae;const kn={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let Tn=J({},kn);function Rn(){({instance:Ae}=ot({setup(){const{state:a,toggle:o}=lt();return()=>r(Pn,re(a,{"onUpdate:show":o}),null)}}))}function En(e){return _e?new Promise((a,o)=>{Ae||Rn(),Ae.open(J({},Tn,e,{callback:t=>{(t==="confirm"?a:o)(t)}}))}):Promise.resolve(void 0)}const Jn=e=>En(J({showCancelButton:!0},e)),Xe=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),On=e=>({x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}),Oe=ne("image-preview")[1],Ze=2.6,zn={src:String,show:Boolean,active:Number,minZoom:Ce(j),maxZoom:Ce(j),rootWidth:Ce(Number),rootHeight:Ce(Number),disableZoom:Boolean,doubleScale:Boolean,closeOnClickImage:Boolean,closeOnClickOverlay:Boolean};var Ln=Q({props:zn,emits:["scale","close","longPress"],setup(e,{emit:a,slots:o}){const t=Se({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,initializing:!1,imageRatio:0}),l=_t(),s=_(),S=_(),y=_(!1),h=_(!1);let m=0;const u=H(()=>{const{scale:f,moveX:C,moveY:k,moving:U,zooming:N,initializing:p}=t,ge={transitionDuration:N||U||p?"0s":".3s"};return(f!==1||h.value)&&(ge.transform=`matrix(${f}, 0, 0, ${f}, ${C}, ${k})`),ge}),b=H(()=>{if(t.imageRatio){const{rootWidth:f,rootHeight:C}=e,k=y.value?C/t.imageRatio:f;return Math.max(0,(t.scale*k-f)/2)}return 0}),x=H(()=>{if(t.imageRatio){const{rootWidth:f,rootHeight:C}=e,k=y.value?C:f*t.imageRatio;return Math.max(0,(t.scale*k-C)/2)}return 0}),T=(f,C)=>{var k;if(f=ue(f,+e.minZoom,+e.maxZoom+1),f!==t.scale){const U=f/t.scale;if(t.scale=f,C){const N=$e((k=s.value)==null?void 0:k.$el),p={x:N.width*.5,y:N.height*.5},ge=t.moveX-(C.x-N.left-p.x)*(U-1),Re=t.moveY-(C.y-N.top-p.y)*(U-1);t.moveX=ue(ge,-b.value,b.value),t.moveY=ue(Re,-x.value,x.value)}else t.moveX=0,t.moveY=h.value?m:0;a("scale",{scale:f,index:e.active})}},R=()=>{T(1)},L=()=>{const f=t.scale>1?1:2;T(f,f===2||h.value?{x:l.startX.value,y:l.startY.value}:void 0)};let i,c,v,g,w,E,M,q,d=!1;const P=f=>{const{touches:C}=f;if(i=C.length,i===2&&e.disableZoom)return;const{offsetX:k}=l;l.start(f),c=t.moveX,v=t.moveY,q=Date.now(),d=!1,t.moving=i===1&&(t.scale!==1||h.value),t.zooming=i===2&&!k.value,t.zooming&&(g=t.scale,w=Xe(C))},F=f=>{const{touches:C}=f;if(l.move(f),t.moving){const{deltaX:k,deltaY:U}=l,N=k.value+c,p=U.value+v;if((N>b.value||N<-b.value)&&!d&&l.isHorizontal()){t.moving=!1;return}d=!0,ie(f,!0),t.moveX=ue(N,-b.value,b.value),t.moveY=ue(p,-x.value,x.value)}if(t.zooming&&(ie(f,!0),C.length===2)){const k=Xe(C),U=g*k/w;E=On(C),T(U,E)}},O=f=>{var C;const k=(C=S.value)==null?void 0:C.$el,U=k.firstElementChild,N=f.target===k,p=U==null?void 0:U.contains(f.target);!e.closeOnClickImage&&p||!e.closeOnClickOverlay&&N||a("close")},W=f=>{if(i>1)return;const C=Date.now()-q,k=250;l.isTap.value&&(C<k?e.doubleScale?M?(clearTimeout(M),M=null,L()):M=setTimeout(()=>{O(f),M=null},k):O(f):C>Ft&&a("longPress"))},X=f=>{let C=!1;if((t.moving||t.zooming)&&(C=!0,t.moving&&c===t.moveX&&v===t.moveY&&(C=!1),!f.touches.length)){t.zooming&&(t.moveX=ue(t.moveX,-b.value,b.value),t.moveY=ue(t.moveY,-x.value,x.value),t.zooming=!1),t.moving=!1,c=0,v=0,g=1,t.scale<1&&R();const k=+e.maxZoom;t.scale>k&&T(k,E)}ie(f,C),W(f),l.reset()},fe=()=>{const{rootWidth:f,rootHeight:C}=e,k=C/f,{imageRatio:U}=t;y.value=t.imageRatio>k&&U<Ze,h.value=t.imageRatio>k&&U>=Ze,h.value&&(m=(U*f-C)/2,t.moveY=m,t.initializing=!0,Mt(()=>{t.initializing=!1})),R()},ce=f=>{const{naturalWidth:C,naturalHeight:k}=f.target;t.imageRatio=k/C,fe()};return oe(()=>e.active,R),oe(()=>e.show,f=>{f||R()}),oe(()=>[e.rootWidth,e.rootHeight],fe),tt("touchmove",F,{target:H(()=>{var f;return(f=S.value)==null?void 0:f.$el})}),ye({resetScale:R}),()=>{const f={loading:()=>r(Ve,{type:"spinner"},null)};return r(Wt,{ref:S,class:Oe("swipe-item"),onTouchstartPassive:P,onTouchend:X,onTouchcancel:X},{default:()=>[o.image?r("div",{class:Oe("image-wrap")},[o.image({src:e.src})]):r(gt,{ref:s,src:e.src,fit:"contain",class:Oe("image",{vertical:y.value}),style:u.value,onLoad:ce},f)]})}}});const[An,he]=ne("image-preview"),$n=["show","teleport","transition","overlayStyle","closeOnPopstate"],Vn={show:Boolean,loop:V,images:it(),minZoom:de(1/3),maxZoom:de(3),overlay:V,closeable:Boolean,showIndex:V,className:Pe,closeIcon:D("clear"),transition:String,beforeClose:Function,doubleScale:V,overlayClass:Pe,overlayStyle:Object,swipeDuration:de(300),startPosition:de(0),showIndicators:Boolean,closeOnPopstate:V,closeOnClickImage:V,closeOnClickOverlay:V,closeIconPosition:D("top-right"),teleport:[String,Object]};var mt=Q({name:An,props:Vn,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:a,slots:o}){const t=_(),l=_(),s=Se({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),S=()=>{if(t.value){const g=$e(t.value.$el);s.rootWidth=g.width,s.rootHeight=g.height,t.value.resize()}},y=g=>a("scale",g),h=g=>a("update:show",g),m=()=>{Me(e.beforeClose,{args:[s.active],done:()=>h(!1)})},u=g=>{g!==s.active&&(s.active=g,a("change",g))},b=()=>{if(e.showIndex)return r("div",{class:he("index")},[o.index?o.index({index:s.active}):`${s.active+1} / ${e.images.length}`])},x=()=>{if(o.cover)return r("div",{class:he("cover")},[o.cover()])},T=()=>{s.disableZoom=!0},R=()=>{s.disableZoom=!1},L=()=>r(Xt,{ref:t,lazyRender:!0,loop:e.loop,class:he("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:u,onDragEnd:R,onDragStart:T},{default:()=>[e.images.map((g,w)=>r(Ln,{ref:E=>{w===s.active&&(l.value=E)},src:g,show:e.show,active:s.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:s.rootWidth,rootHeight:s.rootHeight,disableZoom:s.disableZoom,doubleScale:e.doubleScale,closeOnClickImage:e.closeOnClickImage,closeOnClickOverlay:e.closeOnClickOverlay,onScale:y,onClose:m,onLongPress:()=>a("longPress",{index:w})},{image:o.image}))]}),i=()=>{if(e.closeable)return r(te,{role:"button",name:e.closeIcon,class:[he("close-icon",e.closeIconPosition),Ut],onClick:m},null)},c=()=>a("closed"),v=(g,w)=>{var E;return(E=t.value)==null?void 0:E.swipeTo(g,w)};return ye({resetScale:()=>{var g;(g=l.value)==null||g.resetScale()},swipeTo:v}),Te(S),oe([Ke,Ge],S),oe(()=>e.startPosition,g=>u(+g)),oe(()=>e.show,g=>{const{images:w,startPosition:E}=e;g?(u(+E),ee(()=>{S(),v(+E,{immediate:!0})})):a("close",{index:s.active,url:w[s.active]})}),()=>r(at,re({class:[he(),e.className],overlayClass:[he("overlay"),e.overlayClass],onClosed:c,"onUpdate:show":h},be(e,$n)),{default:()=>[i(),L(),b(),x()]})}});let xe;const Dn={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,doubleScale:!0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function _n(){({instance:xe}=ot({setup(){const{state:e,toggle:a}=lt(),o=()=>{e.images=[]};return()=>r(mt,re(e,{onClosed:o,"onUpdate:show":a}),null)}}))}const Mn=(e,a=0)=>{if(_e)return xe||_n(),e=Array.isArray(e)?{images:e,startPosition:a}:e,xe.open(J({},Dn,e)),xe};se(mt);const[Fn,A,Un]=ne("uploader");function qe(e,a){return new Promise(o=>{if(a==="file"){o();return}const t=new FileReader;t.onload=l=>{o(l.target.result)},a==="dataUrl"?t.readAsDataURL(e):a==="text"&&t.readAsText(e)})}function vt(e,a){return ke(e).some(o=>o.file?De(a)?a(o.file):o.file.size>+a:!1)}function Nn(e,a){const o=[],t=[];return e.forEach(l=>{vt(l,a)?t.push(l):o.push(l)}),{valid:o,invalid:t}}const Yn=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,Hn=e=>Yn.test(e);function ht(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?Hn(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var jn=Q({props:{name:j,item:Ce(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(e,{emit:a,slots:o}){const t=()=>{const{status:u,message:b}=e.item;if(u==="uploading"||u==="failed"){const x=u==="failed"?r(te,{name:"close",class:A("mask-icon")},null):r(Ve,{class:A("loading")},null),T=le(b)&&b!=="";return r("div",{class:A("mask")},[x,T&&r("div",{class:A("mask-message")},[b])])}},l=u=>{const{name:b,item:x,index:T,beforeDelete:R}=e;u.stopPropagation(),Me(R,{args:[x,{name:b,index:T}],done:()=>a("delete")})},s=()=>a("preview"),S=()=>a("reupload"),y=()=>{if(e.deletable&&e.item.status!=="uploading"){const u=o["preview-delete"];return r("div",{role:"button",class:A("preview-delete",{shadow:!u}),tabindex:0,"aria-label":Un("delete"),onClick:l},[u?u():r(te,{name:"cross",class:A("preview-delete-icon")},null)])}},h=()=>{if(o["preview-cover"]){const{index:u,item:b}=e;return r("div",{class:A("preview-cover")},[o["preview-cover"](J({index:u},b))])}},m=()=>{const{item:u,lazyLoad:b,imageFit:x,previewSize:T,reupload:R}=e;return ht(u)?r(gt,{fit:x,src:u.objectUrl||u.content||u.url,class:A("preview-image"),width:Array.isArray(T)?T[0]:T,height:Array.isArray(T)?T[1]:T,lazyLoad:b,onClick:R?S:s},{default:h}):r("div",{class:A("file"),style:rt(e.previewSize)},[r(te,{class:A("file-icon"),name:"description"},null),r("div",{class:[A("file-name"),"van-ellipsis"]},[u.file?u.file.name:u.url]),h()])};return()=>r("div",{class:A("preview")},[m(),t(),y()])}});const Wn={name:de(""),accept:D("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:de(1/0),imageFit:D("cover"),resultType:D("dataUrl"),uploadIcon:D("photograph"),uploadText:String,deletable:V,reupload:Boolean,afterRead:Function,showUpload:V,modelValue:it(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:V,previewOptions:Object,previewFullImage:V,maxSize:{type:[Number,String,Function],default:1/0}};var Xn=Q({name:Fn,props:Wn,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(e,{emit:a,slots:o}){const t=_(),l=[],s=_(-1),S=_(!1),y=(d=e.modelValue.length)=>({name:e.name,index:d}),h=()=>{t.value&&(t.value.value="")},m=d=>{if(h(),vt(d,e.maxSize))if(Array.isArray(d)){const P=Nn(d,e.maxSize);if(d=P.valid,a("oversize",P.invalid,y()),!d.length)return}else{a("oversize",d,y());return}if(d=Se(d),s.value>-1){const P=[...e.modelValue];P.splice(s.value,1,d),a("update:modelValue",P),s.value=-1}else a("update:modelValue",[...e.modelValue,...ke(d)]);e.afterRead&&e.afterRead(d,y())},u=d=>{const{maxCount:P,modelValue:F,resultType:O}=e;if(Array.isArray(d)){const W=+P-F.length;d.length>W&&(d=d.slice(0,W)),Promise.all(d.map(X=>qe(X,O))).then(X=>{const fe=d.map((ce,f)=>{const C={file:ce,status:"",message:"",objectUrl:URL.createObjectURL(ce)};return X[f]&&(C.content=X[f]),C});m(fe)})}else qe(d,O).then(W=>{const X={file:d,status:"",message:"",objectUrl:URL.createObjectURL(d)};W&&(X.content=W),m(X)})},b=d=>{const{files:P}=d.target;if(e.disabled||!P||!P.length)return;const F=P.length===1?P[0]:[].slice.call(P);if(e.beforeRead){const O=e.beforeRead(F,y());if(!O){h();return}if(et(O)){O.then(W=>{u(W||F)}).catch(h);return}}u(F)};let x;const T=()=>a("closePreview"),R=d=>{if(e.previewFullImage){const P=e.modelValue.filter(ht),F=P.map(O=>(O.objectUrl&&!O.url&&O.status!=="failed"&&(O.url=O.objectUrl,l.push(O.url)),O.url)).filter(Boolean);x=Mn(J({images:F,startPosition:P.indexOf(d),onClose:T},e.previewOptions))}},L=()=>{x&&x.close()},i=(d,P)=>{const F=e.modelValue.slice(0);F.splice(P,1),a("update:modelValue",F),a("delete",d,y(P))},c=d=>{S.value=!0,s.value=d,ee(()=>q())},v=()=>{S.value||(s.value=-1),S.value=!1},g=(d,P)=>{const F=["imageFit","deletable","reupload","previewSize","beforeDelete"],O=J(be(e,F),be(d,F,!0));return r(jn,re({item:d,index:P,onClick:()=>a(e.reupload?"clickReupload":"clickPreview",d,y(P)),onDelete:()=>i(d,P),onPreview:()=>R(d),onReupload:()=>c(P)},be(e,["name","lazyLoad"]),O),be(o,["preview-cover","preview-delete"]))},w=()=>{if(e.previewImage)return e.modelValue.map(g)},E=d=>a("clickUpload",d),M=()=>{if(e.modelValue.length>=+e.maxCount&&!e.reupload)return;const d=e.modelValue.length>=+e.maxCount&&e.reupload,P=e.readonly?null:r("input",{ref:t,type:"file",class:A("input"),accept:e.accept,capture:e.capture,multiple:e.multiple&&s.value===-1,disabled:e.disabled,onChange:b,onClick:v},null);return o.default?ze(r("div",{class:A("input-wrapper"),onClick:E},[o.default(),P]),[[Ne,!d]]):ze(r("div",{class:A("upload",{readonly:e.readonly}),style:rt(e.previewSize),onClick:E},[r(te,{name:e.uploadIcon,class:A("upload-icon")},null),e.uploadText&&r("span",{class:A("upload-text")},[e.uploadText]),P]),[[Ne,e.showUpload&&!d]])},q=()=>{t.value&&!e.disabled&&t.value.click()};return nt(()=>{l.forEach(d=>URL.revokeObjectURL(d))}),ye({chooseFile:q,closeImagePreview:L}),Nt(()=>e.modelValue),()=>r("div",{class:A()},[r("div",{class:A("wrapper",{disabled:e.disabled})},[w(),M()])])}});const Qn=se(Xn);export{Le as B,Kn as F,Qn as U,Jn as a,Gn as b,Pn as s};
